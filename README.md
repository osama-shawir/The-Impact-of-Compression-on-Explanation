# BERT Model Compression & Explainability Analysis

## Overview
This project analyzes how model compression techniques affect BERT model explanations in sentiment analysis tasks, comparing original BERT and DistilBERT models using SHAP explanations. You can find the full report [here](The%20Impact%20of%20Compression%20on%20Explanation.pdf).

## Project Structure
```
├── 

main.py

                    # Entry point
├── 

requirements.txt

           # Dependencies
├── src/
│   ├── analysis/             # Analysis and visualization
│   │   ├── model_analysis.py
|   |   ├── model_performance.py
│   │   └── visualization.py
│   ├── data/                 # Dataset processing
│   │   └── data_loader.py
│   ├── explainer/           # SHAP explanation generation
│   │   └── shapley_explainer.py
│   ├── models/              # Model loading and initialization
│   │   └── model_loader.py
│   └── utils/               # Utility functions
│       └── paths.py
└── outputs/                 # Generated outputs
    ├── model_analysis_results.pkl
    ├── explanations/
    ├── metrics/
    └── visualizations/
        ├── bert_base/
        ├── distilbert/
        └── model_comparison/
```

## Requirements
- Python 3.8+
- PyTorch
- Transformers
- SHAP
- NumPy
- Pandas
- Matplotlib
- Seaborn

## Installation
```bash
git clone <repository-url>
cd <project-directory>
pip install -r requirements.txt
```

## Usage
### Quick Start
```bash
python main.py --fast-mode
```

### Full Analysis
```bash
python main.py
```

## Core Components

### Model Processing
The `src/models/model_loader.py` file handles BERT and DistilBERT model initialization and automatic device selection (CPU/GPU).

### Data Processing
The `src/data/data_loader.py` file manages the IMDB dataset, performs balanced sampling, and handles text preprocessing.

### Explanation Generation
The `src/explainer/shapley_explainer.py` file computes SHAP values and supports GPU acceleration.

### Analysis & Visualization
The `src/analysis/` directory contains:
- `model_analysis.py`: Generates predictions and metrics.
- `visualization.py`: Creates word importance and feature attribution plots.
- `model_performance.py`: Computes classification metrics.

### Utilities
The `src/utils/paths.py` file manages paths and configurations.

## Output Structure
The outputs are organized as follows:
- `model_analysis_results.pkl`: Cached analysis results.
- `performance_predictions_cache.pkl`: Cached predictions.
- `explanations/`: SHAP values.
- `metrics/`: Performance metrics.
- `visualizations/`: Generated plots and HTML reports.

## Features
The project includes interactive word importance visualizations, feature importance plots, model comparison matrices, GPU acceleration support, and an efficient caching system.

## Example Word Importance
Below are examples of word importance in predictions generated by SHAP for BERT and DistilBERT:

### BERT Word Importance
<iframe src="outputs/visualizations/bert_base/word_importance.html" width="100%" height="400px"></iframe>

### DistilBERT Word Importance
<iframe src="outputs/visualizations/distilbert/word_importance.html" width="100%" height="400px"></iframe>

## License
MIT License